{"version":3,"file":"index.modern.js","sources":["../src/index.tsx"],"sourcesContent":["import React, {ComponentType, ReactInstance} from 'react';\nimport ReactDom from 'react-dom';\n\nexport function getLayerRoot(id = 'layer-root'): HTMLElement {\n  let layerRoot = document.getElementById(id);\n\n  if (layerRoot) return layerRoot;\n  layerRoot = document.createElement('div');\n  layerRoot.setAttribute('id', id);\n  document.body.appendChild(layerRoot);\n  return layerRoot;\n}\n\nexport interface LayerType<P = {}> {\n  /**\n   * 子组件实例\n   * @note 只有当子组件为类组件时才有值\n   */\n  instance: ReactInstance | null;\n\n  /**\n   * 挂载组件\n   * @param props 给子组件传递的props\n   */\n  render(props?: Omit<P, 'layer'>): void;\n\n  /**\n   * 销毁组件\n   */\n  destroy(): void;\n  /**\n   * 组件挂载根节点\n   */\n  root: HTMLElement\n}\n\nexport type LayerComponentProps<P> = {\n  layer?: LayerType<P>;\n} & P\n\nexport type LC<P> = ComponentType<LayerComponentProps<P>>\n\n/**\n * 创建浮层\n * @param Component 子组件引用\n * @param root 挂载的根节点，默认#layer-root\n */\nexport default function create<P>(\n    Component: LC<P>,\n    root?: HTMLElement,\n): LayerType<P> {\n  const container = root || getLayerRoot();\n  const layer: LayerType<P> = {\n    instance: null,\n    root: container,\n    render(props: P) {\n      const layerElement = Component.prototype && Component.prototype.render ?\n                  <Component ref={ref} layer={layer} {...props} /> : <Component layer={layer} {...props} />\n\n\n      ReactDom.render(layerElement, container);\n    },\n    destroy() {\n      ReactDom.unmountComponentAtNode(container);\n      layer.instance = null;\n      if (container.parentNode && !container.children.length)\n        container.parentNode.removeChild(container);\n    },\n  };\n\n  function ref(layerComponent: ReactInstance | null) {\n    if (layerComponent) layer.instance = layerComponent;\n  }\n\n  return layer;\n}\n"],"names":["getLayerRoot","id","layerRoot","document","getElementById","createElement","setAttribute","body","appendChild","create","Component","root","container","layer","instance","render","props","layerElement","prototype","React","ref","ReactDom","destroy","unmountComponentAtNode","parentNode","children","length","removeChild","layerComponent"],"mappings":";;;SAGgBA,aAAaC,EAAE,GAAG;AAChC,MAAIC,SAAS,GAAGC,QAAQ,CAACC,cAAT,CAAwBH,EAAxB,CAAhB;AAEA,MAAIC,SAAJ,EAAe,OAAOA,SAAP;AACfA,EAAAA,SAAS,GAAGC,QAAQ,CAACE,aAAT,CAAuB,KAAvB,CAAZ;AACAH,EAAAA,SAAS,CAACI,YAAV,CAAuB,IAAvB,EAA6BL,EAA7B;AACAE,EAAAA,QAAQ,CAACI,IAAT,CAAcC,WAAd,CAA0BN,SAA1B;AACA,SAAOA,SAAP;AACD;SAoCuBO,OACpBC,WACAC;AAEF,QAAMC,SAAS,GAAGD,IAAI,IAAIX,YAAY,EAAtC;AACA,QAAMa,KAAK,GAAiB;AAC1BC,IAAAA,QAAQ,EAAE,IADgB;AAE1BH,IAAAA,IAAI,EAAEC,SAFoB;;AAG1BG,IAAAA,MAAM,CAACC,KAAD;AACJ,YAAMC,YAAY,GAAGP,SAAS,CAACQ,SAAV,IAAuBR,SAAS,CAACQ,SAAV,CAAoBH,MAA3C,GACTI,mBAAA,CAACT,SAAD;AAAWU,QAAAA,GAAG,EAAEA;AAAKP,QAAAA,KAAK,EAAEA;SAAWG,MAAvC,CADS,GAC0CG,mBAAA,CAACT,SAAD;AAAWG,QAAAA,KAAK,EAAEA;SAAWG,MAA7B,CAD/D;AAIAK,MAAAA,QAAQ,CAACN,MAAT,CAAgBE,YAAhB,EAA8BL,SAA9B;AACD,KATyB;;AAU1BU,IAAAA,OAAO;AACLD,MAAAA,QAAQ,CAACE,sBAAT,CAAgCX,SAAhC;AACAC,MAAAA,KAAK,CAACC,QAAN,GAAiB,IAAjB;AACA,UAAIF,SAAS,CAACY,UAAV,IAAwB,CAACZ,SAAS,CAACa,QAAV,CAAmBC,MAAhD,EACEd,SAAS,CAACY,UAAV,CAAqBG,WAArB,CAAiCf,SAAjC;AACH;;AAfyB,GAA5B;;AAkBA,WAASQ,GAAT,CAAaQ,cAAb;AACE,QAAIA,cAAJ,EAAoBf,KAAK,CAACC,QAAN,GAAiBc,cAAjB;AACrB;;AAED,SAAOf,KAAP;AACD;;;;;"}